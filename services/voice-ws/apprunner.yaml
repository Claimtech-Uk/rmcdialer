# Updated: 2025-08-23 - AWS Secrets Manager integration
# Source directory is set to /services/voice-ws in App Runner
version: 1.0
runtime: nodejs18
build:
  commands:
    build:
      - echo "Building in source directory /services/voice-ws"
      - ls -la
      - npm ci --omit=dev
run:
  command: node server.js
  network:
    port: 8080
  env:
    - name: ENVIRONMENT_NAME
      value: staging-development
    - name: AI_VOICE_ALLOWED_ENVIRONMENTS
      value: staging-development
    - name: VOICE_MAX_CONCURRENT_STREAMS
      value: '2'
    - name: VOICE_STREAM_TOKEN
      value: set-a-random-dev-token
    - name: AI_VOICE_MODEL
      value: gpt-4o-realtime-preview-2024-12-17
    - name: AI_VOICE_NAME
      value: alloy
    - name: DEBUG_OPENAI
      value: 'true'
    - name: DEBUG_TWILIO
      value: 'false'
    - name: OPENAI_API_KEY
      value_from: 'arn:aws:secretsmanager:eu-west-1:730335573400:secret:dev/openai/voice-6gf7ef'
   